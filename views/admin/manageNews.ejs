<!-- views/admin/news/manage.ejs -->
<%- include("../partials/adminheader.ejs") %>

<!-- Sidebar Start -->
<%- include("./menu/sidebar.ejs") %>
<!-- Sidebar End -->

<!-- Content Start -->
<div class="content">
  <!-- Navbar Start -->
  <%- include("./menu/navbar.ejs") %>
  <!-- Navbar End -->

  <div class="container-fluid pt-4 px-4">

    <div class="d-flex justify-content-between align-items-center mb-3">
  <h3 class="mb-0">Manage News</h3>
  <a href="/admin/add-news" class="btn btn-success">
    <i class="fas fa-plus-circle mr-1"></i> Post News
  </a>
</div>


    <!-- Search and Filter Form -->
    <form method="GET" action="/admin/manage-news" class="mb-4">
      <div class="row">
        <div class="col-md-4">
          <input
            type="text"
            name="search"
            class="form-control"
            placeholder="Search by title"
            value="<%= search %>"
          />
        </div>
        <div class="col-md-4">
          <select name="category" class="form-control">
            <option value="">All Categories</option>
            <option value="Faith" <%= category === "Faith" ? "selected" : "" %>>Faith</option>
            <option value="Youth" <%= category === "Youth" ? "selected" : "" %>>Youth</option>
            <option value="Community" <%= category === "Community" ? "selected" : "" %>>Community</option>
          </select>
        </div>
        <div class="col-md-4">
          <button type="submit" class="btn btn-success">Filter</button>
        </div>
      </div>
    </form>

    <!-- News Table -->
    <table class="table table-bordered">
      <thead>
        <tr>
          <th>Title</th>
          <th>Category</th>
          <th>Author</th>
          <th>Created At</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        <% if (news.length === 0) { %>
  <tr>
    <td colspan="5" class="text-center text-muted">No news posts found.</td>
  </tr>
<% } else { %>
  <% news.forEach((item) => { %>
    <tr>
      <td><%= item.title %></td>
      <td><%= item.category %></td>
      <td><%= item.author %></td>
      <td><%= new Date(item.created_at).toLocaleDateString() %></td>
      <td>
        <a href="/admin/news/view/<%= item.id %>" class="btn btn-info btn-sm">View</a>
        <a href="/admin/news/edit/<%= item.id %>" class="btn btn-warning btn-sm">Edit</a>
        <form
          action="/admin/news/delete/<%= item.id %>"
          method="POST"
          style="display:inline;"
          onsubmit="return confirm('Are you sure you want to delete this news article?');"
        >
          <button type="submit" class="btn btn-danger btn-sm">Delete</button>
        </form>
      </td>
    </tr>
  <% }) %>
<% } %>

      </tbody>
    </table>

    <!-- Pagination -->
    <nav>
      <ul class="pagination">
        <% for (let i = 1; i <= totalPages; i++) { %>
          <li class="page-item <%= currentPage === i ? 'active' : '' %>">
            <a class="page-link" href="?page=<%= i %>&search=<%= search %>&category=<%= category %>"><%= i %></a>
          </li>
        <% } %>
      </ul>
    </nav>
  </div>

  <!-- Footer Start -->
  <%- include("../partials/adminfooter.ejs") %>
  <!-- Footer End -->

<!-- Content End -->
