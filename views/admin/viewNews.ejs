<%- include("../partials/adminheader.ejs") %>
<%- include("./menu/sidebar.ejs") %>

<div class="content">
  <%- include("./menu/navbar.ejs") %>

  <div class="container-fluid pt-4 px-4">
    <div class="bg-light p-4 rounded">
      <h4 class="mb-3"><%= news.title %></h4>

      <div class="mb-3">
        <small class="text-muted">
          <i class="fa fa-calendar-alt"></i> 
          <%= new Date(news.post_date).toDateString() %> | 
          <i class="fa fa-user"></i> <%= news.author %> |
          <i class="fa fa-tags"></i> 
          <%= Array.isArray(news.tags) 
  ? news.tags.join(", ") 
  : (news.tags.includes("[") ? JSON.parse(news.tags).join(", ") : news.tags) %>

        </small>
      </div>

      <p><strong>Summary:</strong> <%= news.summary %></p>

      <div class="mb-4">
        <img src="/uploads/news/<%= news.cover_image %>" class="img-fluid rounded mb-3" style="max-height: 300px;">
      </div>

      <h5>Full Content</h5>
      <p><%= news.content %></p>

      <%
  let gallery = [];
  try {
    if (news.gallery && typeof news.gallery === "string") {
      gallery = JSON.parse(news.gallery);
    } else if (Array.isArray(news.gallery)) {
      gallery = news.gallery;
    }
  } catch (err) {
    gallery = [];
  }
%>

<% if (gallery.length > 0) { %>
  <h5>Gallery</h5>
  <div class="row">
    <% gallery.forEach(img => { %>
      <div class="col-md-4 mb-3">
        <img src="/uploads/news/<%= img %>" class="img-fluid rounded shadow">
      </div>
    <% }) %>
  </div>
<% } %>


      <div class="text-center mt-4">
        <a href="/admin/manage-news" class="btn btn-outline-primary">Back to News List</a>
      </div>
    </div>
  </div>

  <%- include("../partials/adminfooter.ejs") %>

