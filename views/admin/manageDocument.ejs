<%- include("../partials/adminheader.ejs") %>

<!-- Sidebar Start -->
<%- include("./menu/sidebar.ejs") %>
<!-- Sidebar End -->

<!-- Content Start -->
<div class="content">
  <!-- Navbar Start -->

  <%- include("./menu/navbar.ejs") %>
  <!-- Blank Start -->
  <div class="container-fluid pt-4 px-4">
  <!-- Upload Document Button -->
<div class="mb-3 text-end">
  <a href="/admin/add-document" class="btn btn-success">
    <i class="fas fa-upload"></i> Upload Document
  </a>
</div>

<!-- Manage Documents Header + Filter -->
<div class="d-flex justify-content-between align-items-center mb-3">
  <h4 class="mb-0">Manage Documents</h4>

  <form class="d-flex" method="GET" action="/admin/manage-document">
    <input type="text" name="search" value="<%= search %>" class="form-control me-2" placeholder="Search..." />
    <select name="category" class="form-control me-2">
      <option value="">All Categories</option>
      <option value="Legal Documents" <%= category === 'Legal Documents' ? 'selected' : '' %>>Legal</option>
      <option value="Organizational Structure" <%= category === 'Organizational Structure' ? 'selected' : '' %>>Structure</option>
      <option value="Media & Presentations" <%= category === 'Media & Presentations' ? 'selected' : '' %>>Media</option>
    </select>
    <button class="btn btn-outline-success" type="submit">Filter</button>
  </form>
</div>


  <div class="bg-light p-4 rounded">
    <table class="table table-bordered table-hover">
      <thead>
        <tr>
          <th>#</th>
          <th>Title</th>
          <th>Category</th>
          <th>Preview</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        <% if (documents.length > 0) { %>
          <% documents.forEach((doc, index) => { %>
            <tr>
              <td><%= index + 1 %></td>
              <td><%= doc.title %></td>
              <td><%= doc.category %></td>
              <td>
  <% console.log(doc.filepath); %>
  <a href="<%= doc.file_path %>" target="_blank" class="btn btn-sm btn-info">
    <i class="fas fa-eye"></i>
  </a>
</td>

              <td>
                <a href="<%= doc.file_path %>" class="btn btn-sm btn-success" download>
                  <i class="fas fa-download"></i>
                </a>
                <form method="POST" action="/admin/documents/delete/<%= doc.id %>" class="d-inline" onsubmit="return confirm('Delete this document?')">
                  <button class="btn btn-sm btn-danger"><i class="fas fa-trash-alt"></i></button>
                </form>
              </td>
            </tr>
          <% }); %>
        <% } else { %>
          <tr><td colspan="5" class="text-center">No documents found.</td></tr>
        <% } %>
      </tbody>
    </table>

    <!-- Pagination -->
    <% if (totalPages > 1) { %>
      <nav>
        <ul class="pagination justify-content-center">
          <% for (let i = 1; i <= totalPages; i++) { %>
            <li class="page-item <%= currentPage === i ? 'active' : '' %>">
              <a class="page-link" href="?page=<%= i %>&search=<%= search %>&category=<%= category %>"><%= i %></a>
            </li>
          <% } %>
        </ul>
      </nav>
    <% } %>
  </div>
</div>

  <!-- Blank End -->

  <!-- Footer Start -->
  <%- include("../partials/adminfooter.ejs") %>

